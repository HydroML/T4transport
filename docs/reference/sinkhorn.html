<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sinkhorn Distance by Cuturi (2013) — sinkhorn • T4transport</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sinkhorn Distance by Cuturi (2013) — sinkhorn" />
<meta property="og:description" content="Due to high computational cost for linear programming approaches to compute 
Wasserstein distance, Cuturi (2013) proposed an entropic regularization 
scheme as an efficient approximation to the original problem. This comes with 
a regularization parameter \(\lambda &amp;gt; 0\) in the term
$$\lambda h(\Gamma) = \lambda \sum_{m,n} \Gamma_{m,n} \log (\Gamma_{m,n}).$$
As \(\lambda\rightarrow 0\), 
the solution to an approximation problem approaches to the solution of a 
true problem. However, we have an issue with numerical underflow. Our 
implementation returns an error when it happens, so please use a larger number 
when necessary." />
<meta property="og:image" content="https://kyoustat.com/T4transport/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163713603-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163713603-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">T4transport</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/kyoustat">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/kyoustat/T4cluster">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:kyoustat@gmail.com">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sinkhorn Distance by Cuturi (2013)</h1>
    
    <div class="hidden name"><code>sinkhorn.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Due to high computational cost for linear programming approaches to compute 
Wasserstein distance, Cuturi (2013) proposed an entropic regularization 
scheme as an efficient approximation to the original problem. This comes with 
a regularization parameter \(\lambda &gt; 0\) in the term
$$\lambda h(\Gamma) = \lambda \sum_{m,n} \Gamma_{m,n} \log (\Gamma_{m,n}).$$
As \(\lambda\rightarrow 0\), 
the solution to an approximation problem approaches to the solution of a 
true problem. However, we have an issue with numerical underflow. Our 
implementation returns an error when it happens, so please use a larger number 
when necessary.</p>
    </div>

    <pre class="usage"><span class='fu'>sinkhorn</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>Y</span>, p <span class='op'>=</span> <span class='fl'>2</span>, wx <span class='op'>=</span> <span class='cn'>NULL</span>, wy <span class='op'>=</span> <span class='cn'>NULL</span>, lambda <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>sinkhornD</span><span class='op'>(</span><span class='va'>D</span>, p <span class='op'>=</span> <span class='fl'>2</span>, wx <span class='op'>=</span> <span class='cn'>NULL</span>, wy <span class='op'>=</span> <span class='cn'>NULL</span>, lambda <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>an \((M\times P)\) matrix of row observations.</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>an \((N\times P)\) matrix of row observations.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>an exponent for the order of the distance (default: 2).</p></td>
    </tr>
    <tr>
      <th>wx</th>
      <td><p>a length-\(M\) marginal density that sums to \(1\). If <code>NULL</code> (default), uniform weight is set.</p></td>
    </tr>
    <tr>
      <th>wy</th>
      <td><p>a length-\(N\) marginal density that sums to \(1\). If <code>NULL</code> (default), uniform weight is set.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>a regularization parameter (default: 0.1).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>extra parameters including</p><dl>
<dt>maxiter</dt><dd><p>maximum number of iterations (default: 496).</p></dd>
<dt>abstol</dt><dd><p>stopping criterion for iterations (default: 1e-10).</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>D</th>
      <td><p>an \((M\times N)\) distance matrix \(d(x_m, y_n)\) between two sets of observations.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a named list containing</p><dl>
<dt>distance</dt><dd><p>\(\mathcal{W}_p\) distance value</p></dd>
<dt>iteration</dt><dd><p>the number of iterations it took to converge.</p></dd>
<dt>plan</dt><dd><p>an \((M\times N)\) nonnegative matrix for the optimal transport plan.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Cuturi M (2013).
&#8220;Sinkhorn distances: Lightspeed computation of optimal transport.&#8221;
In <em>Proceedings of the 26th international conference on neural information processing systems - volume 2</em>,  NIPS'13, 2292--2300.
Number of pages: 9
Place: Lake Tahoe, Nevada.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#-------------------------------------------------------------------</span>
<span class='co'>#  Wasserstein Distance between Samples from Two Bivariate Normal</span>
<span class='co'>#</span>
<span class='co'># * class 1 : samples from Gaussian with mean=(-1, -1)</span>
<span class='co'># * class 2 : samples from Gaussian with mean=(+1, +1)</span>
<span class='co'>#-------------------------------------------------------------------</span>
<span class='co'>## SMALL EXAMPLE</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>=</span> <span class='fl'>20</span>
<span class='va'>n</span> <span class='op'>=</span> <span class='fl'>10</span>
<span class='va'>X</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>*</span><span class='fl'>2</span>, mean<span class='op'>=</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='co'># m obs. for X</span>
<span class='va'>Y</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>*</span><span class='fl'>2</span>, mean<span class='op'>=</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='co'># n obs. for Y</span>

<span class='co'>## COMPARE WITH WASSERSTEIN </span>
<span class='va'>outw</span> <span class='op'>=</span> <span class='fu'><a href='wasserstein.html'>wasserstein</a></span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>Y</span><span class='op'>)</span>
<span class='va'>skh1</span> <span class='op'>=</span> <span class='fu'>sinkhorn</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>Y</span>, lambda<span class='op'>=</span><span class='fl'>0.05</span><span class='op'>)</span>
<span class='va'>skh2</span> <span class='op'>=</span> <span class='fu'>sinkhorn</span><span class='op'>(</span><span class='va'>X</span>, <span class='va'>Y</span>, lambda<span class='op'>=</span><span class='fl'>0.10</span><span class='op'>)</span>

<span class='co'>## VISUALIZE : SHOW THE PLAN AND DISTANCE</span>
<span class='va'>pm1</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"wasserstein plan ; distance="</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>outw</span><span class='op'>$</span><span class='va'>distance</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>pm2</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sinkhorn lbd=0.05; distance="</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>skh1</span><span class='op'>$</span><span class='va'>distance</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>pm5</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sinkhorn lbd=0.1 ; distance="</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>skh2</span><span class='op'>$</span><span class='va'>distance</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>opar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>no.readonly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>outw</span><span class='op'>$</span><span class='va'>plan</span>, axes<span class='op'>=</span><span class='cn'>FALSE</span>, main<span class='op'>=</span><span class='va'>pm1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>skh1</span><span class='op'>$</span><span class='va'>plan</span>, axes<span class='op'>=</span><span class='cn'>FALSE</span>, main<span class='op'>=</span><span class='va'>pm2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/image.html'>image</a></span><span class='op'>(</span><span class='va'>skh2</span><span class='op'>$</span><span class='va'>plan</span>, axes<span class='op'>=</span><span class='cn'>FALSE</span>, main<span class='op'>=</span><span class='va'>pm5</span><span class='op'>)</span>
</div><div class='img'><img src='sinkhorn-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='va'>opar</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kisung You.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


