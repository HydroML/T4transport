<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Barycenter by Cuturi &amp; Doucet (2014) — bary14C • T4transport</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Barycenter by Cuturi &amp; Doucet (2014) — bary14C"><meta property="og:description" content="Given \(K\) empirical measures \(\mu_1, \mu_2, \ldots, \mu_K\) of possibly different cardinalities, 
wasserstein barycenter \(\mu^*\) is the solution to the following problem 
$$\sum_{k=1}^K \pi_k \mathcal{W}_p^p (\mu, \mu_k)$$
where \(\pi_k\)'s are relative weights of empirical measures. Here we assume 
either (1) support atoms in Euclidean space are given, or (2) all pairwise distances between 
atoms of the fixed support and empirical measures are given. 
Algorithmically, it is a subgradient method where the each subgradient is 
approximated using the entropic regularization."><meta property="og:image" content="https://kisungyou.com/T4transport/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163713603-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163713603-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">T4transport</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/kisung_you" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/kisungyou/T4cluster" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:kisungyou@outlook.com">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Barycenter by Cuturi &amp; Doucet (2014)</h1>
    
    <div class="hidden name"><code>bary14C.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given \(K\) empirical measures \(\mu_1, \mu_2, \ldots, \mu_K\) of possibly different cardinalities, 
wasserstein barycenter \(\mu^*\) is the solution to the following problem 
$$\sum_{k=1}^K \pi_k \mathcal{W}_p^p (\mu, \mu_k)$$
where \(\pi_k\)'s are relative weights of empirical measures. Here we assume 
either (1) support atoms in Euclidean space are given, or (2) all pairwise distances between 
atoms of the fixed support and empirical measures are given. 
Algorithmically, it is a subgradient method where the each subgradient is 
approximated using the entropic regularization.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">bary14C</span><span class="op">(</span>
  <span class="va">support</span>,
  <span class="va">atoms</span>,
  marginals <span class="op">=</span> <span class="cn">NULL</span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  lambda <span class="op">=</span> <span class="fl">0.1</span>,
  p <span class="op">=</span> <span class="fl">2</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">bary14Cdist</span><span class="op">(</span>
  <span class="va">distances</span>,
  marginals <span class="op">=</span> <span class="cn">NULL</span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  lambda <span class="op">=</span> <span class="fl">0.1</span>,
  p <span class="op">=</span> <span class="fl">2</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>support</dt>
<dd><p>an \((N\times P)\) matrix of rows being atoms for the fixed support.</p></dd>
<dt>atoms</dt>
<dd><p>a length-\(K\) list where each element is an \((N_k \times P)\) matrix of atoms.</p></dd>
<dt>marginals</dt>
<dd><p>marginal distribution for empirical measures; if <code>NULL</code> (default), uniform weights are set for all measures. Otherwise, it should be a length-\(K\) list where each element is a length-\(N_i\) vector of nonnegative weights that sum to 1.</p></dd>
<dt>weights</dt>
<dd><p>weights for each individual measure; if <code>NULL</code> (default), each measure is considered equally. Otherwise, it should be a length-\(K\) vector.</p></dd>
<dt>lambda</dt>
<dd><p>regularization parameter (default: 0.1).</p></dd>
<dt>p</dt>
<dd><p>an exponent for the order of the distance (default: 2).</p></dd>
<dt>...</dt>
<dd><p>extra parameters including</p><dl><dt>abstol</dt>
<dd><p>stopping criterion for iterations (default: 1e-10).</p></dd>

<dt>init.vec</dt>
<dd><p>an initial vector (default: uniform weight).</p></dd>

<dt>maxiter</dt>
<dd><p>maximum number of iterations (default: 496).</p></dd>

<dt>print.progress</dt>
<dd><p>a logical to show current iteration (default: FALSE).</p></dd>


</dl></dd>
<dt>distances</dt>
<dd><p>a length-\(K\) list where each element is an \((N\times N_k)\) pairwise distance between atoms of the fixed support and given measures.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a length-\(N\) vector of probability vector.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cuturi M, Doucet A (2014).
“Fast computation of wasserstein barycenters.”
In Xing EP, Jebara T (eds.), <em>Proceedings of the 31st international conference on international conference on machine learning - volume 32</em>, volume 32 of <em>Proceedings of machine learning research</em>, 685--693.
<a href="http://proceedings.mlr.press/v32/cuturi14.html" class="external-link">http://proceedings.mlr.press/v32/cuturi14.html</a>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#-------------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">#     Wasserstein Barycenter for Fixed Atoms with Two Gaussians</span></span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co"># * class 1 : samples from Gaussian with mean=(-4, -4)</span></span>
<span class="r-in"><span class="co"># * class 2 : samples from Gaussian with mean=(+4, +4)</span></span>
<span class="r-in"><span class="co"># * target support consists of 7 integer points from -6 to 6,</span></span>
<span class="r-in"><span class="co">#   where ideally, weight is concentrated near 0 since it's average!</span></span>
<span class="r-in"><span class="co">#-------------------------------------------------------------------</span></span>
<span class="r-in"><span class="co">## GENERATE DATA</span></span>
<span class="r-in"><span class="co">#  Empirical Measures</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ndat</span> <span class="op">=</span> <span class="fl">100</span></span>
<span class="r-in"><span class="va">dat1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">ndat</span><span class="op">*</span><span class="fl">2</span>, mean<span class="op">=</span><span class="op">-</span><span class="fl">4</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">ndat</span><span class="op">*</span><span class="fl">2</span>, mean<span class="op">=</span><span class="op">+</span><span class="fl">4</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">myatoms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">myatoms</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">dat1</span></span>
<span class="r-in"><span class="va">myatoms</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">dat2</span></span>
<span class="r-in"><span class="va">mydata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#  Fixed Support</span></span>
<span class="r-in"><span class="va">support</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">8</span>,to<span class="op">=</span><span class="fl">8</span>,by<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">                <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="op">-</span><span class="fl">8</span>,to<span class="op">=</span><span class="fl">8</span>,by<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## COMPUTE</span></span>
<span class="r-in"><span class="va">comp1</span> <span class="op">=</span> <span class="fu">bary14C</span><span class="op">(</span><span class="va">support</span>, <span class="va">myatoms</span>, lambda<span class="op">=</span><span class="fl">0.5</span>, maxiter<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">comp2</span> <span class="op">=</span> <span class="fu">bary14C</span><span class="op">(</span><span class="va">support</span>, <span class="va">myatoms</span>, lambda<span class="op">=</span><span class="fl">1</span>,   maxiter<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">comp3</span> <span class="op">=</span> <span class="fu">bary14C</span><span class="op">(</span><span class="va">support</span>, <span class="va">myatoms</span>, lambda<span class="op">=</span><span class="fl">5</span>,   maxiter<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## VISUALIZE</span></span>
<span class="r-in"><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">comp1</span>, main<span class="op">=</span><span class="st">"lambda=0.5"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">comp2</span>, main<span class="op">=</span><span class="st">"lambda=1"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">comp3</span>, main<span class="op">=</span><span class="st">"lambda=5"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="bary14C-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kisung You.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

